<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Pong Game</title>
<style>
  canvas {
    background: black;
    display: block;
    margin: auto;
    border: 2px solid white;
  }
</style>
</head>
<body>
<canvas id="pong" width="800" height="400"></canvas>
<script>

const canvas = document.getElementById("pong");
const context = canvas.getContext("2d");

const paddleWidth = 10;
const paddleHeight = 100;
const ballSize = 10;

let leftPaddle = {
	x: 0, 
	y: canvas.height / 2 - paddleHeight / 2, 
	dy: 0 
};
let rightPaddle = { 
	x: canvas.width - paddleWidth, 
	y: canvas.height / 2 - paddleHeight / 2, 
	dy: 0
};
let ball = { 
	x: canvas.width / 2, 
	y: canvas.height / 2, 
	dx: 4 * (Math.random() > 0.5 ? 1 : -1),
	dy: 4 * (Math.random() > 0.5 ? 1 : -1)
};

const speed = 5;

function draw() {
	context.clearRect(0, 0, canvas.width, canvas.height);
	context.fillStyle = "white"; // Sets color for everything drawn next

	context.fillRect(leftPaddle.x, leftPaddle.y, paddleWidth, paddleHeight);
	context.fillRect(rightPaddle.x, rightPaddle.y, paddleWidth, paddleHeight);
	context.fillRect(ball.x, ball.y, ballSize, ballSize);

	// context.beginPath();                // Start a new path
	// context.arc(ball.x, ball.y, (ballSize / 3) * 2, 0, 2 * Math.PI); // Define circle
	// context.fill();                     // Fill the circle with the current fillStyle
	// context.closePath();                //
}

function movePaddles() {
	leftPaddle.y += leftPaddle.dy;
	rightPaddle.y += rightPaddle.dy;

	// Prevent paddles from going out of bounds
	if (leftPaddle.y < 0) leftPaddle.y = 0;
	if (leftPaddle.y + paddleHeight > canvas.height) leftPaddle.y = canvas.height - paddleHeight;
	if (rightPaddle.y < 0) rightPaddle.y = 0;
	if (rightPaddle.y + paddleHeight > canvas.height) rightPaddle.y = canvas.height - paddleHeight;
}

function moveBall() {
	ball.x += ball.dx;
	ball.y += ball.dy;

	if (ball.y <= 0 || ball.y + ballSize >= canvas.height) {
		ball.dy = -ball.dy;
	}

	if (
		(ball.x <= leftPaddle.x + paddleWidth && ball.x >= leftPaddle.x &&
		ball.y + ballSize >= leftPaddle.y && ball.y <= leftPaddle.y + paddleHeight) ||
		(ball.x + ballSize >= rightPaddle.x && ball.x + ballSize <= rightPaddle.x + paddleWidth &&
		ball.y + ballSize >= rightPaddle.y && ball.y <= rightPaddle.y + paddleHeight)
	)
	{
		ball.dx = -ball.dx;
	}

	// Reset ball if it goes off screen
	if (ball.x < 0 || ball.x > canvas.width) {

		if (ball.x < 0)
			console.log("1 point for right");
		else
			console.log("1 point for left");

		ball.x = canvas.width / 2;
		ball.y = canvas.height / 2;
		ball.dx = 4 * (Math.random() > 0.5 ? 1 : -1);
		ball.dy = 4 * (Math.random() > 0.5 ? 1 : -1);
	}
}

function update() {
	movePaddles();
	moveBall();
	draw();

	// console.log(ball);
	
	requestAnimationFrame(update);
}

// as long as we are pressing the rightPaddle.dy have values != 0
// all that with the function is called one time
document.addEventListener("keydown", (e) => {
	switch (e.key) {
		case "ArrowUp": rightPaddle.dy = -speed; break;
		case "ArrowDown": rightPaddle.dy = speed; break;
		case "w": leftPaddle.dy = -speed; break;
		case "s": leftPaddle.dy = speed; break;
	}
});

// SO COOL
// document.addEventListener("keyup", (e) => {
// 	switch (e.key) {
// 		case "ArrowUp":
// 		case "ArrowDown": rightPaddle.dy = 0; break;
// 		case "w":
// 		case "s": leftPaddle.dy = 0; break;
// 	}
// });

update();

</script>
</body>
</html>
